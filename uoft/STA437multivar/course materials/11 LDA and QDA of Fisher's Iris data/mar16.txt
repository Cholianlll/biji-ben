> iris <- scan("iris.txt",what=list("c",0,0,0,0))
> species <- iris[[1]]
> lsepal <- iris[[2]]
> wsepal <- iris[[3]]
> lpetal <- iris[[4]]
> wpetal <- iris[[5]]
> library(MASS)
> species <- factor(species)
> colours <- c(rep("red",50),rep("blue",50),rep("cyan",50))
> pairs(cbind(lsepal,wsepal,lpetal,wpetal),col=colours)

> r <- lda(species~lsepal+wsepal+lpetal+wpetal,CV=T)
> round(r$posterior[1:50,],2)  # posterior probabilities for the 3 species
> # based on cross-validation
   setosa versi virgi
1       1     0     0
2       1     0     0
3       1     0     0
4       1     0     0
5       1     0     0
6       1     0     0
7       1     0     0
8       1     0     0
9       1     0     0
10      1     0     0
11      1     0     0
12      1     0     0
13      1     0     0
14      1     0     0
15      1     0     0
16      1     0     0
17      1     0     0
18      1     0     0
19      1     0     0
20      1     0     0
21      1     0     0
22      1     0     0
23      1     0     0
24      1     0     0
25      1     0     0
26      1     0     0
27      1     0     0
28      1     0     0
29      1     0     0
30      1     0     0
31      1     0     0
32      1     0     0
33      1     0     0
34      1     0     0
35      1     0     0
36      1     0     0
37      1     0     0
38      1     0     0
39      1     0     0
40      1     0     0
41      1     0     0
42      1     0     0
43      1     0     0
44      1     0     0
45      1     0     0
46      1     0     0
47      1     0     0
48      1     0     0
49      1     0     0
50      1     0     0
    setosa versi virgi
51       0  1.00  0.00
52       0  1.00  0.00
53       0  1.00  0.00
54       0  1.00  0.00
55       0  1.00  0.00
56       0  1.00  0.00
57       0  0.98  0.02
58       0  1.00  0.00
59       0  1.00  0.00
60       0  1.00  0.00
61       0  1.00  0.00
62       0  1.00  0.00
63       0  1.00  0.00
64       0  0.99  0.01
65       0  1.00  0.00
66       0  1.00  0.00
67       0  0.98  0.02
68       0  1.00  0.00
69       0  0.94  0.06
70       0  1.00  0.00
71       0  0.18  0.82
72       0  1.00  0.00
73       0  0.79  0.21
74       0  1.00  0.00
75       0  1.00  0.00
76       0  1.00  0.00
77       0  1.00  0.00
78       0  0.66  0.34
79       0  0.99  0.01
80       0  1.00  0.00
81       0  1.00  0.00
82       0  1.00  0.00
83       0  1.00  0.00
84       0  0.10  0.90
85       0  0.95  0.05
86       0  0.99  0.01
87       0  1.00  0.00
88       0  1.00  0.00
89       0  1.00  0.00
90       0  1.00  0.00
91       0  1.00  0.00
92       0  1.00  0.00
93       0  1.00  0.00
94       0  1.00  0.00
95       0  1.00  0.00
96       0  1.00  0.00
97       0  1.00  0.00
98       0  1.00  0.00
99       0  1.00  0.00
100      0  1.00  0.00
    setosa versi virgi
101      0  0.00  1.00
102      0  0.00  1.00
103      0  0.00  1.00
104      0  0.00  1.00
105      0  0.00  1.00
106      0  0.00  1.00
107      0  0.09  0.91
108      0  0.00  1.00
109      0  0.00  1.00
110      0  0.00  1.00
111      0  0.01  0.99
112      0  0.00  1.00
113      0  0.00  1.00
114      0  0.00  1.00
115      0  0.00  1.00
116      0  0.00  1.00
117      0  0.01  0.99
118      0  0.00  1.00
119      0  0.00  1.00
120      0  0.30  0.70
121      0  0.00  1.00
122      0  0.00  1.00
123      0  0.00  1.00
124      0  0.11  0.89
125      0  0.00  1.00
126      0  0.00  1.00
127      0  0.21  0.79
128      0  0.14  0.86
129      0  0.00  1.00
130      0  0.16  0.84
131      0  0.00  1.00
132      0  0.00  1.00
133      0  0.00  1.00
134      0  0.79  0.21
135      0  0.16  0.84
136      0  0.00  1.00
137      0  0.00  1.00
138      0  0.01  0.99
139      0  0.21  0.79
140      0  0.00  1.00
141      0  0.00  1.00
142      0  0.00  1.00
143      0  0.00  1.00
144      0  0.00  1.00
145      0  0.00  1.00
146      0  0.00  1.00
147      0  0.01  0.99
148      0  0.00  1.00
149      0  0.00  1.00
150      0  0.02  0.98
> sum(r$class!=species)  # number of misclassified observations
[1] 3
> r
Call:
lda(species ~ lsepal + wsepal + lpetal + wpetal)

Prior probabilities of groups:
   setosa     versi     virgi 
0.3333333 0.3333333 0.3333333 

Group means:
       lsepal wsepal lpetal wpetal
setosa  5.006  3.428  1.462  0.246
versi   5.936  2.770  4.260  1.326
virgi   6.588  2.974  5.552  2.026

Coefficients of linear discriminants:
              LD1         LD2
lsepal  0.8293776  0.02410215
wsepal  1.5344731  2.16452123
lpetal -2.2012117 -0.93192121
wpetal -2.8104603  2.83918785

Proportion of trace:
   LD1    LD2 
0.9912 0.0088 

> # Now do QDA
> r <- qda(species~lsepal+wsepal+lpetal+wpetal,CV=T)
> sum(r$class!=species)
[1] 4



