> data(UN1)
> UN1
                       Fertility PPgdp
Afghanistan                 6.80    98
Albania                     2.28  1317
Algeria                     2.80  1784
Angola                      7.20   739
Argentina                   2.44  7163
Armenia                     1.15   687
Australia                   1.70 18788
Austria                     1.28 23260
Azerbaijan                  2.10   695
Bahamas                     2.29 14856
Bahrain                     2.66 12012
Bangladesh                  3.46   345
Barbados                    1.50  9255
Belarus                     1.20  1217
Belgium                     1.66 22351
Belize                      3.15  3123
Benin                       5.66   361
Bermuda                     1.67 44579
Bhutan                      5.02   241
Bolivia                     3.82   935
Bosnia-Herzegovina          1.30  1117
Botswana                    3.70  2872
Brazil                      2.21  2888
Brunei                      2.48 12435
Bulgaria                    1.10  1622
Burkina.Faso                6.68   203
Burundi                     6.80   107
Cambodia                    4.77   233
Cameroon                    4.61   557
Canada                      1.48 22385
Cape.Verde                  3.30  1259
Central.African.Rep         4.92   242
Chad                        6.65   127
Chile                       2.35  3992
China                       1.83   918
Hong.Kong                   1.00 23499
Macao                       1.10 14281
Colombia                    2.62  1900
Comoros                     4.90   278
Congo                       6.29   779
Cook.Islands                3.50  4388
Costa.Rica                  2.28  4148
Cote.dIvoire                4.73   637
Croatia                     1.65  4558
Cuba                        1.55  2545
Cyprus                      1.90 11449
Czech.Rep                   1.16  5501
Dem.Rep.Congo               6.70   138
Denmark                     1.77 30265
Djibouti                    5.70   819
Dominican.Rep               2.71  2500
Ecuador                     2.76  1425
Egypt                       3.29  1390
El.Salvador                 2.88  2189
Equatorial.Guinea           5.89  3940
Eritrea                     5.43   177
Estonia                     1.22  4010
Ethiopia                    6.14    90
Fiji                        2.88  2046
Finland                     1.73 23456
France                      1.89 21990
Fr.Guiana                   3.33  7737
Fr.Polynesia                2.44 13891
Gabon                       3.99  3379
Gambia                      4.70   300
Georgia                     1.40   601
Germany                     1.35 22418
Ghana                       4.11   265
Greece                      1.27 10727
Guadeloupe                  2.10 10323
Guatemala                   4.41  1717
Guinea                      5.82   375
Guinea-Bissau               7.10   174
Guyana                      2.31   936
Haiti                       3.98   431
Honduras                    3.72   960
Hungary                     1.20  5209
Iceland                     1.95 27281
India                       3.01   467
Indonesia                   2.35   678
Iran                        2.33  5645
Ireland                     1.90 26725
Israel                      2.70 18816
Italy                       1.23 18928
Jamaica                     2.36  2990
Japan                       1.32 32540
Jordan                      3.57  1726
Kazakhstan                  1.95  1441
Kenya                       4.00   367
Kiribati                    3.80   468
N.Korea                     1.41   571
S.Korea                     2.02  8955
Kuwait                      2.66 16782
Kyrgyzstan                  2.64   306
Laos                        4.78   324
Latvia                      1.10  3212
Lebanon                     2.18  5087
Lesotho                     3.84   419
Liberia                     6.80   256
Libya                       3.02  5099
Liechtenstein               1.64 34504
Lithuania                   1.25  3442
Luxembourg                  1.73 43041
Madagascar                  5.70   278
Malawi                      6.10   129
Malaysia                    2.90  3748
Maldives                    5.33  1947
Mali                        7.00   200
Malta                       1.77  9245
Marshall.Is                 3.68  1938
Martinique                  1.90 10723
Mauritania                  5.79   353
Mauritius                   1.95  3787
Mexico                      2.50  6150
Micronesia                  3.80  2215
Mongolia                    2.42   417
Morocco                     2.75  1145
Mozambique                  5.63   196
Namibia                     4.56  1639
Nepal                       4.26   226
Netherlands                 1.72 23785
Neth.Antilles               2.05 12149
New.Caledonia               2.45 15750
New.Zealand                 2.01 13185
Nicaragua                   3.75   489
Niger                       8.00   176
Nigeria                     5.42   435
Norway                      1.80 36445
Oman                        4.96  7421
Pakistan                    5.08   418
Palau                       3.00  6179
Panama                      2.70  3391
Papua.New.Guinea            4.09   545
Paraguay                    3.84  1286
Peru                        2.86  2053
Philippines                 3.18   924
Poland                      1.26  4657
Portugal                    1.45 10944
Puerto.Rico                 1.89 19083
Qatar                       3.22 30493
Moldova                     1.40   346
Reunion                     2.30  9188
Romania                     1.32  1698
Russia                      1.14  2139
Rwanda                      5.74   205
Saint.Kitts.and.Nevis       2.41  8426
Saint.Lucia                 2.27  4994
St.Vincent/Grenadines       2.23  2940
Samoa                       4.12  1402
Sao.Tome.and.Principe       3.99   312
Saudi.Arabia                4.53  7724
Senegal                     4.97   479
Serbia.and.Montenegro.      1.65  1008
Seychelles                  2.00  7850
Sierra.Leone                6.50   164
Singapore                   1.36 20755
Slovakia                    1.28  3767
Slovenia                    1.14  9463
Solomon.Islands             4.42   760
Somalia                     7.25   110
South.Africa                2.61  2550
Spain                       1.15 14234
Sri.Lanka                   2.01   827
Sudan                       4.39   376
Suriname                    2.45  1965
Swaziland                   4.54  1204
Sweden                      1.64 23680
Switzerland                 1.41 34449
Syria                       3.32  4976
Tajikistan                  3.06   172
Thailand                    1.93  1858
Macedonia                   1.90  1723
Timor-Leste                 3.85   438
Togo                        5.33   273
Tonga                       3.71  1284
Trinidad.and.Tobago         1.55  6817
Tunisia                     2.01  2077
Turkey                      2.43  2136
Turkmenistan                2.70  1263
Uganda                      7.10   239
Ukraine                     1.15   763
United.Arab.Emirates        2.82 19816
United.Kingdom              1.60 24186
Tanzania                    5.11   263
USA                         2.11 34788
Uruguay                     2.30  5514
Uzbekistan                  2.44   418
Vanuatu                     4.13  1085
Venezuela                   2.72  5009
Viet.Nam                    2.30   416
Yemen                       7.01   431
Zambia                      5.64   345
Zimbabwe                    3.90   703

> names(UN1)
[1] "Fertility" "PPgdp"

> Fertility <- UN1[,c(1)]
> Fertility
  [1] 6.80 2.28 2.80 7.20 2.44 1.15 1.70 1.28 2.10 2.29 2.66 3.46 1.50 1.20 1.66 3.15 5.66 1.67 5.02 3.82 1.30 3.70 2.21 2.48
 [25] 1.10 6.68 6.80 4.77 4.61 1.48 3.30 4.92 6.65 2.35 1.83 1.00 1.10 2.62 4.90 6.29 3.50 2.28 4.73 1.65 1.55 1.90 1.16 6.70
 [49] 1.77 5.70 2.71 2.76 3.29 2.88 5.89 5.43 1.22 6.14 2.88 1.73 1.89 3.33 2.44 3.99 4.70 1.40 1.35 4.11 1.27 2.10 4.41 5.82
 [73] 7.10 2.31 3.98 3.72 1.20 1.95 3.01 2.35 2.33 1.90 2.70 1.23 2.36 1.32 3.57 1.95 4.00 3.80 1.41 2.02 2.66 2.64 4.78 1.10
 [97] 2.18 3.84 6.80 3.02 1.64 1.25 1.73 5.70 6.10 2.90 5.33 7.00 1.77 3.68 1.90 5.79 1.95 2.50 3.80 2.42 2.75 5.63 4.56 4.26
[121] 1.72 2.05 2.45 2.01 3.75 8.00 5.42 1.80 4.96 5.08 3.00 2.70 4.09 3.84 2.86 3.18 1.26 1.45 1.89 3.22 1.40 2.30 1.32 1.14
[145] 5.74 2.41 2.27 2.23 4.12 3.99 4.53 4.97 1.65 2.00 6.50 1.36 1.28 1.14 4.42 7.25 2.61 1.15 2.01 4.39 2.45 4.54 1.64 1.41
[169] 3.32 3.06 1.93 1.90 3.85 5.33 3.71 1.55 2.01 2.43 2.70 7.10 1.15 2.82 1.60 5.11 2.11 2.30 2.44 4.13 2.72 2.30 7.01 5.64
[193] 3.90

> PPgdp <- UN1[,c(2)]
> PPgdp
  [1]    98  1317  1784   739  7163   687 18788 23260   695 14856 12012   345  9255  1217 22351  3123   361 44579   241   935
 [21]  1117  2872  2888 12435  1622   203   107   233   557 22385  1259   242   127  3992   918 23499 14281  1900   278   779
 [41]  4388  4148   637  4558  2545 11449  5501   138 30265   819  2500  1425  1390  2189  3940   177  4010    90  2046 23456
 [61] 21990  7737 13891  3379   300   601 22418   265 10727 10323  1717   375   174   936   431   960  5209 27281   467   678
 [81]  5645 26725 18816 18928  2990 32540  1726  1441   367   468   571  8955 16782   306   324  3212  5087   419   256  5099
[101] 34504  3442 43041   278   129  3748  1947   200  9245  1938 10723   353  3787  6150  2215   417  1145   196  1639   226
[121] 23785 12149 15750 13185   489   176   435 36445  7421   418  6179  3391   545  1286  2053   924  4657 10944 19083 30493
[141]   346  9188  1698  2139   205  8426  4994  2940  1402   312  7724   479  1008  7850   164 20755  3767  9463   760   110
[161]  2550 14234   827   376  1965  1204 23680 34449  4976   172  1858  1723   438   273  1284  6817  2077  2136  1263   239
[181]   763 19816 24186   263 34788  5514   418  1085  5009   416   431   345   703
> m1 <- lm(log(Fertility,10)~log(PPgdp,10))
> summary(m1)

Call:
lm(formula = log(Fertility, 10) ~ log(PPgdp, 10))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48587 -0.08148  0.03058  0.11327  0.39130 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     1.17399    0.05879   19.97   <2e-16 ***
log(PPgdp, 10) -0.22116    0.01737  -12.73   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1721 on 191 degrees of freedom
Multiple R-squared:  0.4591,	Adjusted R-squared:  0.4563 
F-statistic: 162.1 on 1 and 191 DF,  p-value: < 2.2e-16

> anova(m1)
Analysis of Variance Table

Response: log(Fertility, 10)
                Df Sum Sq Mean Sq F value    Pr(>F)    
log(PPgdp, 10)   1 4.8004  4.8004  162.15 < 2.2e-16 ***
Residuals      191 5.6546  0.0296                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> plot(log(PPgdp,10), log(Fertility,10))
> abline(lm(log(Fertility,10)~log(PPgdp,10)))

> s1 <- coef(summary(m1))
> s1
                Estimate Std. Error   t value     Pr(>|t|)
(Intercept)     1.173993 0.05879487  19.96761 1.224097e-48
log(PPgdp, 10) -0.221160 0.01736815 -12.73366 2.731002e-27
> s1[2,1] + c(1,-1)*qt(.975,191)*s1[2,2]
[1] -0.186902 -0.255418

> 10^(s1[2,1]) + c(1,-1)*qt(.975,191)*s1[2,2]
[1] 0.6352103 0.5666943

> confint(m1)
                   2.5 %    97.5 %
(Intercept)     1.058022  1.289963
log(PPgdp, 10) -0.255418 -0.186902
> 10^confint(m1)
                    2.5 %     97.5 %
(Intercept)    11.4293649 19.4968018
log(PPgdp, 10)  0.5553694  0.6502764

> new_PPgdp <- data.frame(PPgdp=1000)
> predict(m1,new_PPgdp,interval="prediction")
        fit       lwr       upr
1 0.5105127 0.1700834 0.8509421
> 10^predict(m1,new_PPgdp,interval="prediction")
       fit      lwr      upr
1 3.239759 1.479392 7.094831


> Locality <- UN1[c(1)]

> plot(log(PPgdp,10), log(Fertility,10))
> abline(m1)
> identify(log(PPgdp,10),log(Fertility,10),Locality)
[1]  36 126


> plot(predict(m1),resid(m1))
> abline(0,0)
> identify(predict(m1),resid(m1),Locality)
[1]  55 129
> identify(predict(m1),resid(m1),Locality)
[1]   6 181

