#Last Updated: 23/09/2017




rm(list=ls())





setwd('~/Desktop/Research/AppliedStat2017/L11')
wheat=read.csv('wheat.csv')
head(wheat)
levels(wheat$type)

#Part I
#install.packages('nnet')
library(nnet)
mod.fit<-multinom(formula=type~class+density+hardness+size+weight+moisture,data=wheat)
summary(mod.fit)
library(car)
Anova(mod.fit)

xnew=data.frame(class='hrw',density=1.4,hardness=50,size=2.5,weight=30,moisture=12)
predict(mod.fit,newdata=xnew,type='probs')
predict(mod.fit,newdata=xnew,type='class')

#Part II
levels(wheat$type)
wheat$type.order<-factor(wheat$type,levels=c('Scab','Sprout','Healthy'))
levels(wheat$type.order)


library(MASS)
mod.fit.ord<-polr(formula=type.order~class+density+hardness+size+weight+moisture,data=wheat,method="logistic")
summary(mod.fit.ord)

Anova(mod.fit.ord)
xnew=data.frame(class='hrw',density=1.4,hardness=50,size=2.5,
                weight=30,moisture=12)
predict(mod.fit.ord,newdata=xnew,type='probs')
predict(mod.fit.ord,newdata=xnew,type='class')

